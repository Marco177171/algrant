{% extends './base.html' %}

{% block main %}
    <h6>conversations</h6>
    <form action="{% url 'new_conversation' %}" method="post">
        {% csrf_token %}
        <input class="search" type="text" name="conversation_name" placeholder="Conversation name" required>
        <button class="success" type="submit">Create new</button>
    </form>
    {% if conversations %}
        {% for conversation in conversations %}
            <div class="divider"></div>
            <a href="{% url 'conversation' conversation_id=conversation.id %}">{{conversation.conversation_name}}</a>
            {% for participant in conversation.participants.all %}
            <span>{{ participant.username }}</span>
            {% empty %}
            <span>No participants in this conversation.</span>
            {% endfor %}
            <!-- {% if request.user.id is conversation.admin_id %}
            <div style="text-align: right;">
                <span>admin moves: </span>
                <form action="{% url 'delete_conversation' %}" id="delete-conversation-form" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="conversation_id" value="{{conversation.id}}">
                    <a href="#" onclick="document.getElementById('delete-conversation-form').submit(); return false;">Delete</a>
                </form>
            </div>
            {% endif %} -->
            <div style="text-align: right;">
                <a href="{% url 'chat_settings' conversation_id=conversation.id %}">Settings</a>
            </div>
        {% endfor %}
    {% else %}
        <div class="divider"></div>
        <h3>No chats yet</h3>
    {% endif %}
{% endblock %}